# 光伏关断器实验数据管理系统 - 产品需求文档 (PRD)

## 1. 产品概述

### 1.1 产品定位
光伏关断器实验数据管理系统是一个高端、工业化的Web应用平台，专门用于管理、分析和可视化光伏关断器的实验数据。系统采用现代化的设计理念，提供直观的数据展示大屏、智能的数据分析功能和专业的实验仿真能力。

### 1.2 目标用户
- 光伏设备研发工程师
- 质量检测人员
- 实验室管理人员
- 数据分析人员

### 1.3 核心价值
- **数据可视化**：通过工业级大屏展示实时数据和关键指标
- **智能分析**：提供趋势分析、异常检测等高级分析功能
- **实验仿真**：模拟不同条件下的关断器工作状态
- **高效管理**：支持批量数据导入、清洗和管理

## 2. 功能需求

### 2.1 数据展示大屏
#### 2.1.1 实时监控面板
- **实时功率曲线**
  - 展示最近24小时的功率变化趋势
  - 支持多设备对比显示
  - 提供缩放和平移功能
  
- **累计发电量统计**
  - 日/周/月/年累计发电量
  - 同比/环比增长率
  - 发电效率分析

- **设备状态分布**
  - 饼图展示在线/离线/故障设备占比
  - 设备地理分布图（如有位置信息）
  - 设备类型分布统计

- **故障率统计**
  - 故障率趋势图
  - 故障类型分布
  - MTBF（平均故障间隔时间）计算

- **关断时间统计**
  - 平均关断时间
  - 关断时间分布直方图
  - 异常关断事件标记

- **设备数量统计**
  - 在线设备总量（实时更新）
  - 离线设备总量（实时更新）
  - 关断设备总量（实时更新）

#### 2.1.2 设计要求
- 深色主题，科技感强
- 使用渐变色和发光效果
- 数据实时刷新动画
- 响应式布局，支持大屏展示

### 2.2 实验仿真页面
#### 2.2.1 仿真控制面板
- **输入参数设置**
  - 输入电压（0-1000V，精度0.1V）
  - 输入电流（0-100A，精度0.1A）
  - 环境温度（-40°C - 85°C）
  - 光照强度（0-1000 W/m²）

- **控制按钮**
  - 开启按钮（绿色，带发光效果）
  - 关断按钮（红色，带警示动画）
  - 紧急停止按钮
  - 重置按钮

- **输出显示**
  - 关断时电压曲线（标准值：45V）
  - 关断时电流曲线（标准值：12A）
  - 关断响应时间
  - 功率损耗计算

#### 2.2.2 仿真结果展示
- 实时波形显示（使用WebGL渲染）
- 关键参数标注
- 仿真日志记录
- 结果导出功能

### 2.3 数据文件管理
#### 2.3.1 文件上传
- 支持Excel文件拖拽上传
- 批量文件上传
- 上传进度显示
- 文件格式验证

#### 2.3.2 数据预览
- 表格形式预览数据
- 支持分页和搜索
- 数据统计信息显示
- 异常数据高亮

#### 2.3.3 数据清洗
- 自动识别异常值
- 缺失值处理选项
- 数据格式标准化
- 清洗日志记录

#### 2.3.4 数据管理
- 文件列表展示
- 文件分类管理
- 批量删除/下载
- 数据版本控制

### 2.4 数据分析功能
#### 2.4.1 趋势分析
- 多维度数据趋势图
- 移动平均线
- 季节性分析
- 预测模型

#### 2.4.2 异常检测
- 基于统计的异常检测
- 异常事件时间线
- 异常原因分析
- 异常报警设置

#### 2.4.3 报表生成
- 自定义报表模板
- 定期报表生成
- PDF/Excel导出
- 报表分享功能

## 3. 非功能需求

### 3.1 性能要求
- 页面加载时间 < 3秒
- 数据刷新延迟 < 1秒
- 支持10万条数据的流畅展示
- 并发用户数 > 100

### 3.2 安全要求
- HTTPS加密传输
- 数据备份机制
- 操作日志记录
- 数据访问权限控制

### 3.3 可用性要求
- 系统可用性 > 99.9%
- 跨浏览器兼容
- 移动端适配
- 国际化支持

### 3.4 设计要求
- **视觉风格**：工业化、高科技、专业
- **色彩方案**：深色背景 + 蓝绿色调 + 橙色警示
- **动画效果**：流畅、科技感
- **图标风格**：线性图标、统一风格

## 4. 技术架构

### 4.1 前端技术栈
- **框架**：Next.js 14+ (App Router)
- **UI库**：Tailwind CSS + shadcn/ui
- **图表**：Recharts + D3.js
- **状态管理**：Zustand
- **动画**：Framer Motion
- **3D效果**：Three.js（用于高级可视化）

### 4.2 后端技术栈
- **数据库**：Supabase (PostgreSQL)
- **认证**：Supabase Auth
- **存储**：Supabase Storage
- **实时数据**：Supabase Realtime

### 4.3 部署方案
- **托管平台**：Netlify
- **CDN**：Netlify Edge
- **监控**：Netlify Analytics

## 5. 数据模型

### 5.1 主要数据表
```sql
-- 设备表
devices (
  id: uuid PRIMARY KEY,
  device_address: text UNIQUE,
  device_type: text,
  status: text, -- 'online', 'offline', 'shutdown'
  created_at: timestamp,
  updated_at: timestamp
)

-- 实验数据表
experiment_data (
  id: uuid PRIMARY KEY,
  device_id: uuid REFERENCES devices(id),
  current: numeric,
  voltage: numeric,
  power: numeric,
  timestamp: timestamp,
  created_at: timestamp
)

-- 文件记录表
file_records (
  id: uuid PRIMARY KEY,
  filename: text,
  file_url: text,
  upload_time: timestamp,
  data_count: integer,
  status: text -- 'processing', 'completed', 'failed'
)

-- 异常记录表
anomaly_records (
  id: uuid PRIMARY KEY,
  device_id: uuid REFERENCES devices(id),
  anomaly_type: text,
  anomaly_value: jsonb,
  detected_at: timestamp
)

-- 仿真记录表
simulation_records (
  id: uuid PRIMARY KEY,
  input_voltage: numeric,
  input_current: numeric,
  output_voltage: numeric,
  output_current: numeric,
  shutdown_time: numeric,
  simulation_data: jsonb,
  created_at: timestamp
)
```

## 6. 界面设计规范

### 6.1 布局结构
- **导航栏**：顶部固定，包含logo和主要导航
- **侧边栏**：可折叠，包含详细功能菜单
- **主内容区**：响应式网格布局
- **状态栏**：底部显示系统状态

### 6.2 组件规范
- **卡片**：圆角、阴影、hover效果
- **按钮**：渐变背景、发光边框
- **图表**：深色背景、荧光色数据线
- **表格**：斑马纹、悬停高亮

### 6.3 交互规范
- **加载状态**：骨架屏 + 进度条
- **错误提示**：Toast通知 + 详细错误信息
- **成功反馈**：动画效果 + 声音提示
- **数据更新**：渐变过渡 + 数字滚动

## 7. 项目里程碑

### 第一阶段：基础架构（第1周）
- Next.js项目搭建
- Supabase数据库配置
- 基础UI组件开发
- 路由和导航实现

### 第二阶段：核心功能（第2-3周）
- 数据展示大屏开发
- 文件上传和管理功能
- 数据表格和预览功能
- 基础数据分析功能

### 第三阶段：高级功能（第4周）
- 实验仿真功能
- 高级数据分析
- 报表生成功能
- 性能优化

### 第四阶段：部署上线（第5周）
- UI/UX优化
- 测试和bug修复
- Netlify部署配置
- 文档完善

## 8. 风险和挑战

### 8.1 技术风险
- 大数据量渲染性能优化
- 实时数据同步的稳定性
- 复杂图表的交互性能

### 8.2 解决方案
- 使用虚拟滚动和分页加载
- 实现数据缓存和增量更新
- 采用WebGL加速图表渲染

## 9. 成功指标

- 页面加载速度提升50%
- 数据处理效率提升80%
- 用户操作流程简化60%
- 系统稳定性达到99.9%

## 10. 未来扩展

- AI智能分析功能
- 移动APP开发
- IoT设备直连
- 多语言支持
- 企业级权限管理